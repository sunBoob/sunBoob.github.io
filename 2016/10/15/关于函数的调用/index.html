<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="SunBoBo"><link rel="alternative" href="/atom.xml" title="SunBoBo" type="application/atom+xml"><link rel="icon" href="/favicon.png"><title>关于函数的调用 - SunBoBo</title><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--><script src="/js/jquery-3.1.1.min.js"></script><script src="/js/fancybox/jquery.fancybox.min.js"></script></head><body style="opacity:0;"><header class="head"><h1 class="head-title u-fl"><a href="/">SunBoBo</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a class="head-nav__link" href="/archives">Catalog（目录）</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"> <time class="post__time" datetime="2016-10-14T16:00:00.000Z">October 15, 2016</time><h1 class="post__title"><a href="/2016/10/15/关于函数的调用/">关于函数的调用</a></h1><div class="post__main echo"><p>​    最近做了一下简单的复习，总结了一些，好久都没有关注的知识点，都已经忘的差不多了，所以总结出来和大家分享一下</p>
<p>​    那下面咱们来讨论一下关于函数调用的一些问题。</p>
<h3 id="1、上下文调用的应用（技巧）"><a href="#1、上下文调用的应用（技巧）" class="headerlink" title="1、上下文调用的应用（技巧）"></a>1、上下文调用的应用（技巧）</h3><p>​    我觉得函数调用中，最常用的就是上下文调用。而且是最有效、最实际的调用方法。我们先来看一下</p>
<p>​    我们先来考虑一下，上下文调用的核心思想是什么？<br>​    其实简单来说，就是借用，例如，我们将伪数组转换成数组：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">var arrlike = &#123;length：0&#125;;</div><div class="line">arrlike[arrlike.length++]=&quot;abc&quot;;</div></pre></td></tr></table></figure>
<p>​    我们看到，借用数组的方法也可以实现该功能<br>​    那么我们来析一个问题，假如要利用数组得到一个新数组，要求与原数组一模一样，你能想到什么？对，没错，数组的拷贝。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var arr=[1,2,3];</div><div class="line">//slice</div><div class="line">var newarr = arr.slice()</div></pre></td></tr></table></figure>
<p>​    那么我们再来思考一个问题，slice它里面的实现逻辑应该是什么呢？<br>​    我们可以想象得到，slice中一定会有对数组进行遍历。注意，遍历的东西在代码中怎么表示？<br>​    在方法内部，其实就是在遍历 this，将this的每一个元素放到一个新数组中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">function slice(start,end)&#123;</div><div class="line">start = start || 0,</div><div class="line">ende = end || this.length;</div><div class="line">var ret = [];</div><div class="line">for(var i = start;i&lt;end;i++)&#123;</div><div class="line">ret.push(this[i]);</div><div class="line">&#125;</div><div class="line">return ret;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>​    <strong>注意</strong>：slice遍历的是this，将this[i]放到一个新数组中，那么请问，和我们要转换伪数组有什么关系？</p>
<p>​    假设一下，如果我们的伪数组也有这个slice方法，并且调用slice方法，会返回一个与伪数组一模一样的真数组。</p>
<pre><code>Array.prototype.slice.call(arrlike)
</code></pre><p>​    借用数组方法，将伪数组转换成数组，在我们开发的时候，这个技巧使用的非常频繁，例如将页面中所有的div增加一个背景色，我们来看下传统的处理办法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var divs = document.getElementsByTagName(&quot;div&quot;);</div><div class="line">for(var i = 0; i &lt; divs.length ; i++)&#123;</div><div class="line">  divs[i].style.backgroundColor = &quot;red&quot;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>那我们来对比一下。利用这个技巧实现一下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Array.prototype</div><div class="line">	.slice.call(document.getElementsByTagName(&quot;div&quot;))</div><div class="line">	.forEach(v =&gt; v.style.backgroundColor = &quot;red&quot;);</div></pre></td></tr></table></figure>
<p>很明显，这个技巧，是不是行云流水一般？</p>
<p>​    不过需要注意的是，Array.prototype 写起来比较麻烦，一般我都是考虑使用下面的语法: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[].slice.call(...)</div></pre></td></tr></table></figure>
<hr>
</div></header></article><div class="comments" id="lv-container" data-id="city" data-uid="your uid"><script>(function(d, s) {var j, e = d.getElementsByTagName(s)[0];if (typeof LivereTower === 'function') { return; } j = d.createElement(s);j.src = 'https://cdn-city.livere.com/js/embed.dist.js';j.async = true;e.parentNode.insertBefore(j, e);})(document, 'script');</script></div></main><footer class="foot"><div class="foot-copy">&copy; 2016-2018 SunBoBo</div></footer><script src="/js/scroller.js"></script><script src="/js/main.js"></script></body></html>